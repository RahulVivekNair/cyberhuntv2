<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
  <meta charset="utf-8">
  <title>Cyberhunt Admin Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Tailwind + DaisyUI -->
  <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>

<body class="min-h-screen bg-base-200 font-sans flex items-center justify-center">

  <form id="adminLoginForm" class="w-full max-w-sm">
    <fieldset class="fieldset bg-base-100 border-base-300 rounded-box border p-6 shadow-xl">
      <legend class="fieldset-legend text-xl font-bold text-primary">Admin Login</legend>

      <!-- Feedback alert -->
      <div id="feedback" class="hidden mb-4"></div>

      <label for="name" class="label">Admin Name</label>
      <input type="text" id="name" name="name" placeholder="Enter admin name"
        class="input input-bordered input-primary w-full" required />

      <label for="password" class="label mt-2">Password</label>
      <input type="password" id="password" name="password" placeholder="Enter password"
        class="input input-bordered input-primary w-full" required />

      <button type="submit" class="btn btn-primary w-full mt-4">Login</button>
    </fieldset>
  </form>

  <script>
    const form = document.getElementById("adminLoginForm");
    const feedback = document.getElementById("feedback");

    // If already logged in, redirect straight to admin panel
    if (document.cookie.includes("adminAuth=")) {
      window.location.href = "/admin";
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const formData = new FormData(form);

      try {
        const res = await fetch("/admin/login", {
          method: "POST",
          body: formData
        });

        if (res.ok) {
          window.location.href = "/admin";
        } else {
          const data = await res.json().catch(() => ({}));
          showFeedback(data.error || "Invalid login!", "error");
        }
      } catch {
        showFeedback("Login failed! Please try again.", "error");
      }
    });

    function showFeedback(message, type = "error") {
      feedback.className = `alert alert-${type} mb-4`;
      feedback.innerHTML = `<span>${message}</span>`;
      feedback.classList.remove("hidden");
    }
  </script>

</body>

</html>